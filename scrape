import requests
from bs4 import BeautifulSoup
import openpyxl
from openpyxl.styles import Font
import re

#Kreiranje Eksel fajla i odredjivanje njegove strukture

dokument = openpyxl.Workbook()
rubrike = ["Politika", "Dijalog", "Društvo", "Ekonomija", "Svet", "Sport","Kultura", "Život","Auto","IT","Ljudi","Beograd","Dodatak Nedelja"]
metapodaci = {
    "A":"NASLOV",
    "B":"AUTOR",
    "C":"DATUM",
    "D":"KLJUČNE REČI",
    "E":"LOKACIJA",
    "F":"UVODNI TEKST"
}

del dokument['Sheet'] #brisanje podrazumevanog lista iz fajla

#kreiranje lista za svaku rubriku i imenovanje kolona u kojima ce biti metapodaci
for rubrika in rubrike:
    
    dokument.create_sheet(title=rubrika)
    tabela = dokument[rubrika]
    for key in metapodaci:
        tabela[str(key)+'1'] = metapodaci[key]
        tabela[str(key)+'1'].font = Font(bold=True)

        tabela.column_dimensions['D'].width = 30    
        tabela.column_dimensions['F'].width = 80


dokument.save('Danas, metapodaci clanaka.xlsx')

  
#Dohvatanje metapodataka
#urlDodaci = ['politika', 'dijalog', 'drustvo', 'ekonomija', 'svet', 'sport', 'kultura', 'zivot', 'auto', 'tehnologije', 'ljudi', 'beograd', 'nedelja']
urlDodaci = ['auto','zivot']
url = 'https://www.danas.rs/rubrika/'



for link in urlDodaci:
    brojac = 1
    listaLinkova = []
    while brojac:
        page = requests.get(url + link + '/page/' + str(brojac) +'/')
        soup = BeautifulSoup(page.content, 'html.parser')
        
        #kada se ode na nepostojecu stranicu, ispisan je tekst u h1 tagu: 'Greška 404: Tražena stranica nije pronađena.'
        #dolazak na tu stranicu znaci da je cela rubrika predjena, pa se while petlja prekida i prelazi se na novu iteraciju for petlje,
        #odnosno, na novu rubriku
        h1 = soup.find('h1').get_text()
        if(h1=='Greška 404: Tražena stranica nije pronađena.'):
            brojac = 0
            print(listaLinkova)
            listaLinkova = []
        
        #nije se doslo do nepostojece stranice - nastavlja se prolazak kroz tekucu rubriku  
        else:
            h2 = soup.find_all('h2', {'class':'article-post-title'})               

            for naslov in h2:
                listaLinkova.append(naslov.find('a')['href'])

            brojac+=1       
        
       
       
        
    linkoviMP = ['https://www.danas.rs/auto/da-li-nam-je-potreban-razvoj-mikromobilnosti/', 'https://www.danas.rs/auto/zasto-je-vazno-koristiti-zimski-dizel/', 'https://www.danas.rs/auto/tojotini-automobili-najprodavaniji-u-2020-godini/', 'https://www.danas.rs/auto/alu-felne-kad-mogu-da-se-poprave-a-kad-su-za-otpad/', 'https://www.danas.rs/auto/mladi-vozaci-najcesce-stradaju-vikendom-u-sitnim-satima/', 'https://www.danas.rs/zivot/kako-unaprediti-biciklisticki-saobracaj-u-srbiji-2/', 'https://www.danas.rs/auto/prakticni-saveti-kako-se-pripremiti-za-voznju-po-snegu-i-ledu/', 'https://www.danas.rs/auto/u-norveskoj-u-2020-registrovano-vise-od-polovine-vozila-na-elektricni-pogon/', 'https://www.danas.rs/auto/objavljena-prva-knjiga-iz-edicije-siguran-smer-vodic-kroz-osnovna-pravila-saobracaja/', 'https://www.danas.rs/auto/koliko-je-epidemija-smanjila-prodaju-automobila-u-srbiji-u-2020-godini/', 'https://www.danas.rs/svet/eu-odobrila-spajanje-fijat-krajslera-i-francuske-grupe-psa/', 'https://www.danas.rs/auto/dzeneral-motors-povlaci-59-miliona-automobila-zbog-vazdusnog-jastuka/', 'https://www.danas.rs/zivot/veliki-uspon-elektricnih-automobila-u-evropi-norveska-i-holandija-lideri/', 'https://www.danas.rs/drustvo/sa-cime-se-sve-u-saobracaju-suocavaju-osobe-sa-invaliditetom-u-srbiji/', 'https://www.danas.rs/drustvo/od-1-novembra-obavezne-zimske-gume/', 'https://www.danas.rs/auto/startap-iz-zrenjanina-napravio-resenje-za-brz-pronalazak-parkinga/', 'https://www.danas.rs/auto/veliki-kvar-na-vozilu-uzeti-rent-a-car-ili-taksi/', 'https://www.danas.rs/auto/zimske-gume-obavezne-od-1-novembra/', 'https://www.danas.rs/auto/50-godina-brenda-range-rover/', 'https://www.danas.rs/zivot/fica-uspomena-na-zemlju-koje-vise-nema/', 'https://www.danas.rs/ekonomija/nema-kompromisa-kada-je-kvalitet-goriva-u-pitanju/', 'https://www.danas.rs/auto/kazne-za-voznju-u-alkoholisanom-stanju/', 'https://www.danas.rs/auto/koje-su-prednosti-zone-30-i-zone-usporenog-saobracaja/', 'https://www.danas.rs/auto/brendiranje-automobila/', 'https://www.danas.rs/auto/najvise-korisceno-prevozno-sredstvo-u-srbiji-je-automobil/', 'https://www.danas.rs/auto/pet-kultnih-automobila-na-srpskim-drumovima/', 'https://www.danas.rs/auto/uticaj-mobilnog-telefona-na-nastanak-saobracajne-nezgode/', 'https://www.danas.rs/auto/udeo-elektricnih-automobila-porastao-u-eu/', 'https://www.danas.rs/auto/korona-virus-smanjio-prodaju-novih-ali-ne-i-polovnih-vozila/', 'https://www.danas.rs/auto/greske-u-saobracaju-koje-dovode-do-stradanja-pesaka/', 'https://www.danas.rs/auto/zasto-motociklisti-zauzimaju-visoko-mesto-na-skali-rizika-stradanja/', 'https://www.danas.rs/auto/koliko-je-epidemija-smanjila-prodaju-automobila-u-srbiji/', 'https://www.danas.rs/auto/ko-je-odgovoran-zbog-stradanja-dece-u-saobracaju/', 'https://www.danas.rs/auto/kadilak-predstavio-prvi-elektricni-model-napada-teslu/', 'https://www.danas.rs/auto/nema-krize-za-bogate-posle-tesle-skocile-i-akcije-ferarija/', 'https://www.danas.rs/auto/raste-prodaja-automobila-u-srbiji/', 'https://www.danas.rs/auto/kako-vozaci-dozivljavaju-elektricne-trotinete-u-saobracaju/', 'https://www.danas.rs/auto/raste-interesovanje-za-hibridne-i-elektricne-automobile-u-srbiji/', 'https://www.danas.rs/ekonomija/srpski-auto-sektor-nasa-rizicna-tacka-oslonca/', 'https://www.danas.rs/auto/kako-je-grcka-postala-groblje-polovnih-vozila-zagadjivaca/', 'https://www.danas.rs/auto/pad-prodaje-novih-automobila-u-eu-za-oko-tri-miliona/', 'https://www.danas.rs/auto/najvise-automobila-po-stanovniku-u-eu-ima-luksemburg/', 'https://www.danas.rs/auto/raste-broj-registrovanih-automobila-u-srbiji-prednjace-cetiri-marke-proizvodjaca/', 'https://www.danas.rs/ekonomija/smanjen-broj-ulazaka-putnickih-vozila-u-srbiju/', 'https://www.danas.rs/auto/rast-prodaje-polovnih-automobila-nakon-ukidanja-vanrednog-stanja/', 'https://www.danas.rs/ekonomija/prodaja-polovnih-automobila-gotovo-stala/', 'https://www.danas.rs/svet/drastican-pad-prodaje-automobila-u-hrvatskoj/', 'https://www.danas.rs/auto/kako-se-zastititi-od-virusa-u-automobilu/', 'https://www.danas.rs/auto/bezbedna-voznja-u-doba-korone-vaznija-nego-ikad/', 'https://www.danas.rs/auto/kupovinu-automobila-zbog-korone-odlozilo-dve-trecine-kupaca/', 'https://www.danas.rs/auto/kako-registrovati-auto-sa-auto-placa-ili-iz-salona-tokom-vanrednog-stanja/', 'https://www.danas.rs/auto/korona-odlozila-sajam-automobila-u-beogradu/', 'https://www.danas.rs/svet/otkazan-sajam-automobila-u-zenevi-zbog-korona-virusa/', 'https://www.danas.rs/auto/sta-sve-mozete-sa-probnom-vozackom-dozvolom/', 'https://www.danas.rs/auto/ponovo-radi-ukucavanje-broja-motora/', 'https://www.danas.rs/auto/semafori-koji-nagradjuju-strpljive-vozace-u-indiji/', 'https://www.danas.rs/auto/reno-obustavlja-proizvodnju-u-fabrici-u-juznoj-koreji/', 'https://www.danas.rs/auto/najvise-automobila-u-svetu-obojeno-belom-bojom/', 'https://www.danas.rs/auto/sta-ce-se-desiti-ako-srbija-zabrani-uvoz-evro-3-vozila/', 'https://www.danas.rs/auto/blokirano-ukucavanje-broja-motora-vozaci-ogorceni/', 'https://www.danas.rs/ekonomija/zabrana-euro-3-ce-pogoditi-uvoz-66-000-automobila-godisnje/', 'https://www.danas.rs/auto/kako-uociti-veliku-kilometrazu-kod-polovnog-motocikla/', 'https://www.danas.rs/auto/najskuplji-polovnjak-u-srbiji-u-2019-se-ne-vidja-svaki-dan/', 'https://www.danas.rs/auto/zimski-znak-koji-i-dalje-zbunjuje-vozace/', 'https://www.danas.rs/auto/originalni-ford-mustang-iz-filma-bulit-ide-na-aukciju/', 'https://www.danas.rs/auto/nemci-do-2-000-evra-najtrazeniji-polovnjaci-u-2019-godini/', 'https://www.danas.rs/auto/da-li-elektricni-automobili-zaista-emituju-vise-ugljen-dioksida-od-onih-sa-dizel-motorom/', 'https://www.danas.rs/auto/dw-automobil-na-baterije-za-svaciji-dzep/', 'https://www.danas.rs/auto/kako-je-fica-dobio-ime-i-koji-automobil-je-najmanji-na-svetu/', 'https://www.danas.rs/auto/klarkson-greta-tunberg-ubila-automobilisticke-emisije/', 'https://www.danas.rs/auto/broj-prodatih-novih-putnickih-automobila-u-eu-ove-godine-opao-07-odsto/', 'https://www.danas.rs/auto/najcesce-greske-prilikom-kupovine-zimskih-guma/', 'https://www.danas.rs/zivot/u-eu-najvise-automobila-se-ukrade-u-luksemburgu-najmanje-u-slovackoj-i-estoniji/', 'https://www.danas.rs/auto/vise-od-polovine-vozaca-kupuje-polovne-zimske-pneumatike/', 'https://www.danas.rs/auto/sta-znaci-ms-a-sta-su-prave-zimske-gume/', 'https://www.danas.rs/drustvo/na-svim-vozilima-od-danas-obavezne-zimske-gume/', 'https://www.danas.rs/auto/procredit-banka-na-ekoloskim-cetvorotockasima/', 'https://www.danas.rs/ekonomija/voznja-auto-putem-oko-nisa-besplatna-za-nislije/', 'https://www.danas.rs/svet/luksuzni-automobili-sina-africkog-vodje-prodati-na-aukciji-u-svajcarskoj-za-21-milion-evra/', 'https://www.danas.rs/ekonomija/u-srbiju-se-uveze-oko-120-000-polovnih-automobila-novih-vozila-znatno-manje/', 'https://www.danas.rs/auto/sajam-polovnih-automobila-na-auto-moto-berzi-u-novom-sadu-21-i-22-septembra/', 'https://www.danas.rs/auto/traze-zabranu-velikih-automobila-u-gradovima-nemacke/', 'https://www.danas.rs/auto/vozaci-u-srbiji-se-ne-boje-kazni-prvi-nude-mito/', 'https://www.danas.rs/auto/povodom-15-godina-sajta-polovnjaci-poklanjaju-polovnjaka/', 'https://www.danas.rs/ekonomija/investicioni-plan-za-srbiju-sa-informacijom-o-novom-modelu-ocekuje-se-do-kraja-godine/', 'https://www.danas.rs/auto/koliko-kosta-ukucavanje-novog-broja-motora-tzv-pus-ovanje/', 'https://www.danas.rs/auto/gde-izvaditi-probne-tablice-koja-je-cena-i-na-koliko-mogu-da-se-uzmu/', 'https://www.danas.rs/auto/hands-free-telefoniranje-u-kolima-ce-biti-zabranjeno/', 'https://www.danas.rs/auto/kako-da-vam-ne-oduzmu-auto-nakon-sto-ga-kupite/', 'https://www.danas.rs/auto/kako-spreciti-povredjivanje-dece-u-automobilu/', 'https://www.danas.rs/auto/kako-funkcionise-start-stop-sistem-i-da-li-unistava-motor/', 'https://www.danas.rs/auto/gde-je-sve-dozvoljeno-a-gde-zabranjeno-parkiranje-po-zakonu/', 'https://www.danas.rs/auto/golf-7-karavan-svetogrdje-ili-idealan-porodicni-auto/', 'https://www.danas.rs/auto/luksemburg-najvise-automobila-po-stanovniku/', 'https://www.danas.rs/auto/daimler-i-bosch-razvili-automatsko-parkiranje/', 'https://www.danas.rs/auto/sta-ako-vam-na-tehnickom-pregledu-kazu-da-morate-da-ukucavate-novi-broj-motora/', 'https://www.danas.rs/auto/kakav-faktor-predstavlja-kubikaza-motora-u-savremenim-automobilima/', 'https://www.danas.rs/auto/automobil-za-pravog-agenta-007/', 'https://www.danas.rs/auto/klasican-folksvagenov-kombi-uskoro-u-elektricnoj-verziji/', 'https://www.danas.rs/auto/skocila-vrednost-deonica-kompanije-tesla/', 'https://www.danas.rs/auto/metalik-ljubicasta-bice-najucestalija-boja-za-evropske-automobile/', 'https://www.danas.rs/svet/dajmler-povlaci-60-000-mercedesa-u-nemackoj/', 'https://www.danas.rs/auto/sve-o-ugradnji-metana-i-da-li-se-to-isplati/', 'https://www.danas.rs/auto/kako-preziveti-na-dva-tocka-15-saveta/', 'https://www.danas.rs/auto/kako-se-odredjuje-cena-obaveznog-osiguranja/', 'https://www.danas.rs/auto/pravilno-preticanje-je-bezbedno-preticanje-kako-ga-preziveti/', 'https://www.danas.rs/auto/isplate-li-se-polovne-gume/', 'https://www.danas.rs/svet/medjusobne-optuzbe-za-neuspesno-spajanje-fiat-krajslera-i-renoa/', 'https://www.danas.rs/auto/za-vikend-auto-trka-u-novom-sadu-zatvoren-most-i-petlja/', 'https://www.danas.rs/auto/dzipijada-na-zlatiboru-3/', 'https://www.danas.rs/auto/auto-trka-ovog-vikenda-u-cacku/', 'https://www.danas.rs/ekonomija/nova-gazprom-benzinska-stanica-kod-velike-plane/', 'https://www.danas.rs/auto/na-zvezdari-odrzan-10-medjunarodni-fica-skup/', 'https://www.danas.rs/svet/svake-godine-vise-od-135-miliona-ljudi-pogine-u-saobracajnim-nesrecama/', 'https://www.danas.rs/auto/koliko-kilometara-mozete-preci-nakon-upaljene-lampice-za-gorivo/', 'https://www.danas.rs/auto/mazda-povlaci-190-000-vozila-zbog-problema-s-brisacima/', 'https://www.danas.rs/auto/godisnji-skup-udruzenja-istoricara-automobilizma/', 'https://www.danas.rs/auto/roman-rusinov-sa-posetiocima-sajma-na-standu-kompanije-nis/', 'https://www.danas.rs/auto/sajam-automobila-u-retrovizoru-35-novih-brendova/', 'https://www.danas.rs/auto/g-drive-racing-tim-na-sajmu-automobila-u-beogradu/', 'https://www.danas.rs/auto/medjunarodni-salon-automobila-u-beogradu-od-22-do-31-marta/', 'https://www.danas.rs/auto/tablice-na-automobilima-u-australiji-dobile-emotikone/', 'https://www.danas.rs/auto/koje-su-najtrazenije-marke-automobila-u-eu/', 'https://www.danas.rs/auto/japanska-honda-ce-2021-zatvoriti-svoju-fabriku-u-velikoj-britaniji/', 'https://www.danas.rs/auto/bmw-presidents-award-za-delta-motors-trecu-godinu-za-redom/', 'https://www.danas.rs/auto/cetrdeset-zemalja-saglasno-da-novi-automobili-ubuduce-imaju-i-automatske-kocnice/', 'https://www.danas.rs/auto/g-drive-derivati-domace-proizvodnje-gorivo-koje-stiti-od-smrzavanja/', 'https://www.danas.rs/auto/povlace-1-7-miliona-automobila-sa-smrtonosnim-erbegovima/', 'https://www.danas.rs/auto/sajamska-iznenadjenja-za-ljubitelje-cetvorotockasa-u-martu/', 'https://www.danas.rs/sport/kroserom-u-buducnost/', 'https://www.danas.rs/auto/pogodnosti-prilikom-kupovine-nisotec-antifriza/', 'https://www.danas.rs/auto/svaki-treci-automobil-u-evropi-ofarban-belom-bojom/', 'https://www.danas.rs/auto/u-2018-najtrazeniji-polovnjaci-od-1-000-do-2-000-evra/', 'https://www.danas.rs/ekonomija/sajam-automobila-u-kragujevcu-od-7-do-9-decembra/', 'https://www.danas.rs/svet/koliko-elektricni-automobili-zaista-stite-zivotnu-sredinu/', 'https://www.danas.rs/auto/496145/', 'https://www.danas.rs/auto/tojota-povlaci-188-000-vozila-zbog-vazdusnih-jastuka/', 'https://www.danas.rs/auto/prosecna-starost-automobila-u-srbiji-15-godina/', 'https://www.danas.rs/auto/folksvagen-bmw-i-dajmler-pod-istragom/', 'https://www.danas.rs/auto/jugo-za-borbu-protiv-nlo/', 'https://www.danas.rs/auto/uspesno-otvorena-kruzna-auto-trka-nagrada-beograda-usce-2018/', 'https://www.danas.rs/auto/druzenje-sa-ficom-i-vespom-na-platou-ispred-muzeja-jugoslavije/', 'https://www.danas.rs/auto/u-evropi-milion-elektro-vozila/', 'https://www.danas.rs/auto/kako-da-pripremite-automobil-za-tehnicki-pregled/', 'https://www.danas.rs/auto/bmw-pod-istragom-u-koreji/', 'https://www.danas.rs/auto/ferari-povecao-profit/', 'https://www.danas.rs/auto/kako-do-atesta-za-zatamnjena-stakla-na-vozilu/', 'https://www.danas.rs/auto/gde-je-obavezno-voziti-sa-upaljenim-svetlima-preko-dana/', 'https://www.danas.rs/auto/automobile-poseduje-vise-od-60-odsto-gradjana-srbije/', 'https://www.danas.rs/auto/kako-pripremiti-vozilo-za-putovanje/', 'https://www.danas.rs/auto/u-lihtenstajnu-i-luksemburgu-najvise-automobila-po-broju-stanovnika/', 'https://www.danas.rs/auto/svako-trece-vozilo-prodato-na-lizing/', 'https://www.danas.rs/auto/alfa-romeo-dobitnik-nagrade-zlatni-kompas/', 'https://www.danas.rs/auto/za-ljubitelje-automobila-noc-cuda-15-i-16-juna/', 'https://www.danas.rs/auto/mogu-li-dizelasi-da-se-poprave/', 'https://www.danas.rs/auto/bogat-program-za-vikend-na-miseluku/', 'https://www.danas.rs/auto/volkswagen-80-rodjendan-giganta-kojeg-je-osnovao-hitler/', 'https://www.danas.rs/auto/auto-kuca-kompresor-dobitnik-priznanja-diler-godine/', 'https://www.danas.rs/auto/alfa-romeo-zauzela-prva-tri-mesta-na-mille-miglia-2018/', 'https://www.danas.rs/auto/nemacka-naredila-povlacenje-60-000-porsea-zbog-zagadjenja/', 'https://www.danas.rs/auto/uspostavlja-se-evropska-mreza-za-punjenje-elektricnih-vozila/', 'https://www.danas.rs/auto/sezona-kruznih-auto-trka-startuje-prvog-vikenda-juna-na-stazi-miseluk/', 'https://www.danas.rs/auto/vozila-starija-od-15-godina-moraju-dva-puta-na-tehnicki/', 'https://www.danas.rs/auto/folksvagen-menja-izgled-znaka/', 'https://www.danas.rs/auto/audi-povlaci-12-miliona-vozila/', 'https://www.danas.rs/auto/glavni-u-gradu/', 'https://www.danas.rs/auto/ne-mozemo-mimo-sveta-regulativa-za-elektricna-vozila-nuzna/', 'https://www.danas.rs/auto/pocinje-bg-car-show-najskuplji-izlozeni-auto-lamborghini-huracan-gt3/', 'https://www.danas.rs/auto/oko-380-izlagaca-predstavlja-svoje-brendove/', 'https://www.danas.rs/auto/jubilarna-postanska-marka-beogradskog-sajma/', 'https://www.danas.rs/auto/placanje-na-odlozeno-uz-sa-nama-na-putu-karticu-lojalnosti/', 'https://www.danas.rs/auto/vrednost-lizing-ugovora-visa-od-90-miliona-evra/', 'https://www.danas.rs/auto/seatov-izuzetan-motor-na-metan/', 'https://www.danas.rs/auto/bela-boja-i-dalje-broj-jedan-za-automobile/', 'https://www.danas.rs/auto/hitlerov-mercedes-nije-prodat-na-aukciji-u-las-vegasu/', 'https://www.danas.rs/auto/tehnologije-u-autu-smatra-korisnim-70-odsto-gradjana-srbije/', 'https://www.danas.rs/auto/sajam-obelezilo-14-premijera-automobila/', 'https://www.danas.rs/auto/u-kragujevcu-se-odrzava-12-sajam-automobila-auto-expo/', 'https://www.danas.rs/auto/saveti-za-voznju-u-zimskom-periodu/', 'https://www.danas.rs/auto/da-li-su-elektricni-automobili-samo-za-bogate/', 'https://www.danas.rs/auto/enduro-moto-trke-na-ceru/', 'https://www.danas.rs/auto/predstavljen-novi-model-jeep-wrangler-za-2018/', 'https://www.danas.rs/auto/od-sutra-obavezna-zimska-oprema/', 'https://www.danas.rs/auto/koji-su-najprodavaniji-automobili-ove-godine-u-srbiji/', 'https://www.danas.rs/auto/folksvagen-salje-na-proveru-74000-tuarega-iz-sad/', 'https://www.danas.rs/auto/druzenje-sa-ficom-i-vespom-ispred-muzeja-jugoslavije/', 'https://www.danas.rs/auto/svecano-otvoren-jubilarni-50-srbija-reli/', 'https://www.danas.rs/auto/jubilarni-50-srbija-reli/', 'https://www.danas.rs/auto/francuska-uvodi-nove-subvencije-za-elektroautomobile/', 'https://www.danas.rs/auto/zagarantovan-dobitak-uz-nis-agro-karticu-2/', 'https://www.danas.rs/auto/moto-trka-velika-nagrada-zrenjanina-2/', 'https://www.danas.rs/auto/aditivna-goriva-i-savremeni-trendovi/', 'https://www.danas.rs/auto/aditivirana-goriva-i-savremeni-trendovi/', 'https://www.danas.rs/auto/spektakularni-oldtajmeri-na-24-sata-elegancije/', 'https://www.danas.rs/auto/autotrka-nagrada-beograda-2017/', 'https://www.danas.rs/auto/autotrka-nagrada-beograda-2017-2/', 'https://www.danas.rs/auto/automobil-koji-je-pobedio-vreme/', 'https://www.danas.rs/auto/nisan-i-reno-najprodavaniji-automobili/', 'https://www.danas.rs/auto/volkswagen-mozda-najveci-proizvodjac-automobila/', 'https://www.danas.rs/auto/zasto-je-novo-sluzbeno-vozilo-mudra-investicija/', 'https://www.danas.rs/auto/tablice-sa-c-c-s-z-dj-y-i-w-izlaze-iz-upotrebe/', 'https://www.danas.rs/auto/najprodavaniji-automobili-u-srbiji-su/', 'https://www.danas.rs/auto/amss-svaki-cetvrti-auto-neispravan/', 'https://www.danas.rs/auto/narukvica-koja-ne-da-vozacu-da-zaspi/', 'https://www.danas.rs/auto/nagrada-rakovice-aleksandru-vidosavljevicu/', 'https://www.danas.rs/auto/postanska-markica-posvecena-fiat-500/', 'https://www.danas.rs/auto/fiat-500-uvrsten-u-postavku-moma-u-njujorku/', 'https://www.danas.rs/auto/sta-morate-znati-o-odrzavanju-guma-tokom-leta/', 'https://www.danas.rs/auto/zagrevanje-za-nedeljnu-trku-na-avali/', 'https://www.danas.rs/auto/spektakl-na-uscu/', 'https://www.danas.rs/auto/trka-fica-i-jugica/', 'https://www.danas.rs/auto/sutra-balkan-fica-fest/', 'https://www.danas.rs/auto/pokloni-za-potrosace-na-benzinskim-stanicama-nis-a/', 'https://www.danas.rs/auto/test-otkrio-koji-su-automobili-najbezbedniji-na-putevima/', 'https://www.danas.rs/auto/testirali-smo-hyundai-i10-1-1/', 'https://www.danas.rs/auto/moderni-fica-u-barseloni/', 'https://www.danas.rs/auto/sajam-polovnjaka-u-kragujevcu/', 'https://www.danas.rs/auto/veciti-rivali-vw-jetta-vs-toyota-corolla/', 'https://www.danas.rs/auto/aktuelno-na-sajmu-automobila/', 'https://www.danas.rs/auto/elektricni-automobili-u-srbiji-san-ili-java/', 'https://www.danas.rs/auto/banke-jure-klijente-na-sajmu-automobila/', 'https://www.danas.rs/auto/svaki-cetvrti-auto-kupljen-na-lizing/', 'https://www.danas.rs/auto/proglasen-automobil-godine/', 'https://www.danas.rs/auto/testirali-smo-seat-leon-1-6-mpi/', 'https://www.danas.rs/auto/svecano-otvoren-sajam-automobila/', 'https://www.danas.rs/auto/sutra-se-otvara-sajam-automobila/', 'https://www.danas.rs/auto/da-li-ce-ict-kompanije-preoteti-kupce-automobilskoj-industriji/', 'https://www.danas.rs/auto/preko-30-modela-bmw-grupe-na-medjunarodnom-sajmu/', 'https://www.danas.rs/auto/uporedili-smo-hyundai-tucson-2-0-crdi-i-kia-sportage-2-0-crdi/', 'https://www.danas.rs/auto/testirali-smo-opel-meriva-1-4-turbo/', 'https://www.danas.rs/auto/sajam-automobila-od-24-marta-do-2-aprila/', 'https://www.danas.rs/auto/jubilarni-300-000-model-panda-natural-power/', 'https://www.danas.rs/auto/testirali-smo-peugeot-207-1-4-90-trendy/', 'https://www.danas.rs/auto/testirali-smo-mercedes-a-170-w169/', 'https://www.danas.rs/auto/pezo-kupuje-opel-do-marta/', 'https://www.danas.rs/auto/pezo-kupuje-opel-od-dzeneral-motorsa/', 'https://www.danas.rs/auto/najbolji-polovni-automobil-za-5-000-6-000-evra/', 'https://www.danas.rs/auto/testirali-smo-fiat-grande-punto-1-3-jtd/', 'https://www.danas.rs/auto/svaki-cetvrti-auto-u-srbiji-na-lizing/', 'https://www.danas.rs/auto/testirali-smo-citroen-c3-1-6-bluehdi-75/', 'https://www.danas.rs/auto/folksvagen-pretekao-tojotu/', 'https://www.danas.rs/auto/predstavljen-novi-bmw-serije-5/', 'https://www.danas.rs/auto/da-li-moj-logan-trosi-mnogo-ulja/', 'https://www.danas.rs/auto/testirali-smo-toyota-corolla-1-6-valvematic/', 'https://www.danas.rs/auto/komnenovic-vozacke-dozvole-se-dobijaju-suvise-lako/', 'https://www.danas.rs/auto/hladan-start-motora/', 'https://www.danas.rs/auto/evropski-kompakti-za-4-000-evra/', 'https://www.danas.rs/auto/kako-da-vozite-na-snegu/', 'https://www.danas.rs/auto/predstavljamo-dacia-sandero-loganduster-phase-2/', 'https://www.danas.rs/auto/mikelandjelo-automobilske-industrije/', 'https://www.danas.rs/auto/proglaseni-najbolji-u-moto-sportu/', 'https://www.danas.rs/auto/testirali-smo-citroen-c4-cactus-1-6-bluehdi/', 'https://www.danas.rs/auto/porodicni-auto-za-1-000-evra/', 'https://www.danas.rs/auto/koji-je-suv-bolji-rav4-ili-patriot/', 'https://www.danas.rs/auto/kampanja-nis-i-agencije-za-bezbednost-saobracaja/', 'https://www.danas.rs/auto/koji-je-idealan-auto-za-moju-suprugu/', 'https://www.danas.rs/auto/akcija-amss-ispravno-vozilo-bezbedno-vozilo/', 'https://www.danas.rs/auto/dizelas-ili-benzinac-za-7-000-km-godisnje/', 'https://www.danas.rs/auto/koji-je-najbolji-auto-za-pocetnike/', 'https://www.danas.rs/auto/da-li-je-skoda-fabija-ii-bolja-od-pola/', 'https://www.danas.rs/auto/najbolji-japanski-auto-za-7-000-evra/', 'https://www.danas.rs/auto/testirali-smo-opel-adam-jam-1-2/', 'https://www.danas.rs/auto/kako-da-vam-motor-duze-traje/', 'https://www.danas.rs/auto/zimska-guma-zivot-cuva/', 'https://www.danas.rs/auto/nissan-qashqai-1-2-dig-t-x-tronic/', 'https://www.danas.rs/auto/testirali-smo-opel-astra-g/', 'https://www.danas.rs/auto/najbolji-polovni-automobili-za-2-000-evra/', 'https://www.danas.rs/auto/sta-da-kupim-renault-clio-3-ili-peugeot-207/', 'https://www.danas.rs/auto/koji-auto-je-bolji-bravo-ili-citroen-c4/', 'https://www.danas.rs/auto/koji-karavan-kupiti-za-4-000-evra/', 'https://www.danas.rs/auto/testirali-smo-renault-kadjar-dci-130-4wd/', 'https://www.danas.rs/auto/dzip-americka-ikona/', 'https://www.danas.rs/auto/idealan-auto-za-damu-mercedes-a-klase-auris-ili-civic/', 'https://www.danas.rs/auto/najpogodniji-auto-za-pocetnika/', 'https://www.danas.rs/auto/testirali-smo-peugeot-206-1-4-hdi/', 'https://www.danas.rs/auto/skup-ljubitelja-opel-automobila-na-adi-huji/', 'https://www.danas.rs/auto/testirali-smo-kia-sportage-2-0-crdi/', 'https://www.danas.rs/auto/testirali-smo-infiniti-q50-2-2d/', 'https://www.danas.rs/auto/deset-najvecih-gresaka-pri-izboru-automobila/', 'https://www.danas.rs/auto/testirali-smo-nissan-x-trail-1-6-dci/', 'https://www.danas.rs/auto/koja-je-najbolja-limuzina-za-oko-4-500-evra/', 'https://www.danas.rs/auto/testirali-smo-bmw-116i/', 'https://www.danas.rs/auto/u-uzicu-svecano-otvoren-49-srbija-reli/', 'https://www.danas.rs/auto/polovne-gume-ubijaju-zar-ne/', 'https://www.danas.rs/auto/koji-auto-kupiti-za-1-000-evra/', 'https://www.danas.rs/auto/startovao-peti-medjunarodni-tesla-reli/', 'https://www.danas.rs/auto/renault-megane-grandtour-i-clio-phase-2-stigli-u-srbiju/', 'https://www.danas.rs/auto/testirali-smo-mercedes-cla-200-cdi/', 'https://www.danas.rs/auto/nis-ova-akcija-pomoc-na-putu/', 'https://www.danas.rs/auto/testirali-smo-renault-clio-iv-0-9-tce-gt-line/', 'https://www.danas.rs/auto/najbolji-auto-za-15-000-evra-je/', 'https://www.danas.rs/auto/testirali-smo-citroen-c3-1-4-hdi/', 'https://www.danas.rs/auto/nebezbedno-preticanje/', 'https://www.danas.rs/auto/kako-da-najbrze-prodate-automobil/', 'https://www.danas.rs/auto/testirali-smo-opel-astra-1-6-cdti-ecotec/', 'https://www.danas.rs/auto/koji-novi-mali-auto-kupiti-za-12-000-evra/', 'https://www.danas.rs/auto/testirali-smo-mazda-3-g100/', 'https://www.danas.rs/auto/testirali-smo-ford-focus-1-0-ecoboost/', 'https://www.danas.rs/auto/koje-ulje-da-sipam-u-focus-ii-1-4-16v/', 'https://www.danas.rs/auto/sta-kupiti-dizelas-ili-benzinac/', 'https://www.danas.rs/auto/prevara-kupaca-vracanje-kilometraze/', 'https://www.danas.rs/auto/testirali-smo-fiat-tipo-1-6-mjtd/', 'https://www.danas.rs/auto/zasto-vas-lazu-u-servisu/', 'https://www.danas.rs/auto/najbolji-polovni-automobil-za-6-000-evra/', 'https://www.danas.rs/auto/u-drustvu-sa-ficom-i-vespom/', 'https://www.danas.rs/auto/kako-da-trosite-manje-goriva/', 'https://www.danas.rs/auto/kako-najbolje-odrzavati-automobil/', 'https://www.danas.rs/auto/testirali-smo-toyota-yaris-1-3-bi-tone-plus/', 'https://www.danas.rs/auto/testirali-smo-2-000-km-dacia-logan-mcv-1-5-dci/', 'https://www.danas.rs/auto/testirali-smo-1-000-km-renault-megane-iv-1-2-tce/', 'https://www.danas.rs/auto/testirali-smo-kia-sorento-2-2-crdi-awd/', 'https://www.danas.rs/auto/testirali-smo-volvo-xc90-d5-awd/']
print(len(linkoviMP)//30)
iteracije = len(linkoviMP)//30
for i in range (iteracije):
    stranicaClanka = requests.get(linkoviMP[i])
    stranicaClankaPars = BeautifulSoup(stranicaClanka.content, 'html.parser')
    
    naslov = stranicaClankaPars.find('h1', class_='post-title').string
    autor = stranicaClankaPars.find('span', class_='post-meta author vcard').string.replace('Piše: ','')
    
    datum = stranicaClankaPars.find('time', class_='entry-date published')
    if datum is None:
        datum = stranicaClankaPars.find('time', class_='entry-date published updated')['datetime']
    else:
        datum = datum['datetime']
    
    uvodniTekst = stranicaClankaPars.find('div', class_='post-intro-content content').string
    
    kljucneReciPars = stranicaClankaPars.find('span', class_='post-meta-bottom-tags').find_all('a')
    kljucneReci = ""
    for rec in kljucneReciPars:
        kljucneReci += rec.string
        kljucneReci += ', '
    precisti = slice(0,-2)
    kljucneReci = kljucneReci[precisti]
    
    lokacija = stranicaClankaPars.find('span', class_='post-meta-bottom-locations')
    if lokacija is None:
        lokacija = ''
    else:
        lokacija = lokacija.find('a').string
   
    probica = dokument['Auto']
    probica['A2'] = naslov
    probica['B2'] = autor
    probica['C2'] = datum
    probica['D2'] = kljucneReci
    probica['E2'] = lokacija
    probica['F2'] = uvodniTekst
    print(linkoviMP[i])
    print('Naslov ',naslov)
    print('Autor ',autor)
    print('Datum ',datum)
    print('Uvodni tekst ',uvodniTekst)
    print('Kljucne reci ',kljucneReci)
    print('Lokacija ',lokacija)
    print('\n\n\n\n\n\n')

dokument.save('Danas, metapodaci clanaka.xlsx')        
    
